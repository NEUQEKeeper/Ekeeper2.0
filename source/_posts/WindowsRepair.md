---
title: å¸¸è§ç³»ç»Ÿé—®é¢˜çš„æ­£ç¡®å¤„ç†æ–¹å¼
date: 2022-8-27
cover: /img/hzy.png
description: è‡ªæ•‘æµç¨‹
categories:
  - æ•™ç¨‹
tags:
  - ç³»ç»Ÿ
---

# "åœ¨æ²¡æœ‰é”™è¯¯æ—¥å¿—çš„æƒ…å†µä¸‹å¯¹ä»»ä½•é—®é¢˜è¿›è¡Œæ•…éšœæ’é™¤å°±åƒé—­ç€çœ¼ç›å¼€è½¦ä¸€æ ·"

## å…¥é—¨éƒ¨åˆ†

æ—¢ç„¶ä½ ç‚¹äº†è¿›æ¥ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡ä½ çš„ç”µè„‘å‡ºäº†å‡ºäº†ä¸€ç‚¹å°é—®é¢˜ï¼Œåœ¨ç»§ç»­è§‚çœ‹ä¹‹å‰ï¼Œä½ å¿…é¡»æ¸…æ¥šä¸‹é¢ä¸¤ä¸ªäº‹é¡¹ï¼š

1. æœ¬æ•™å­¦ä»…é™äºç³»ç»Ÿéƒ¨åˆ†ï¼Œä¸åŒ…æ‹¬ç¡¬ä»¶éƒ¨åˆ†ã€‚
2. å¦‚æœä½¿ç”¨ç ´è§£è½¯ä»¶å‡ºç°äº†é—®é¢˜ï¼Œæœ€å¥½çš„è§£å†³æ–¹æ³•æ˜¯é‡è£…ï¼›å› ä¸ºpjè½¯ä»¶çš„ä¿®æ”¹æ‰€å‡ºç°çš„é”™è¯¯å¾ˆæœ‰å¯èƒ½æ˜¯ç ´è§£è¡¥ä¸çš„é—®é¢˜ï¼ˆå¦‚æœ‰å¿…è¦ï¼Œç ´è§£çš„å¤§æ¦‚æ€è·¯ä¹Ÿæ˜¯éœ€è¦äº†è§£çš„ï¼Œè¿™æœ‰åŠ©äºè§£å†³ä¸ºä»€ä¹ˆæˆ‘å°±ä¸å¯ä»¥ï¼‰

ä¸‹é¢å¼€å§‹æ­£å¼å†…å®¹ï¼ˆå«Œéº»çƒ¦ç›´æ¥è·³ç¬¬å››æ­¥ï¼‰ï¼š

åœ¨è¿™é‡Œæˆ‘ä»¬é¦–å…ˆå‡å®šä½ æ˜¯ä¸€ä¸ªæœ‰ä¸€ç‚¹ç”µè„‘çŸ¥è¯†çš„å°ç™½ï¼Œå¦‚æœæœ‰ä»€ä¹ˆåè¯ä¸å¤ªæ¸…æ¥šï¼Œå¯ä»¥ç™¾åº¦ä¸€ä¸‹ï¼›è¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œå› ä¸ºéšåæˆ‘ä»¬ç”¨åˆ°æœç´¢å¼•æ“çš„æ¬¡æ•°ä¼šæ¯”è¾ƒå¤šã€‚

å¥½ï¼Œå‡è®¾ä½ ç°åœ¨é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ã€‚

## ç¬¬ä¸€æ­¥ï¼šå›å¿†é—®é¢˜å‡ºç°ä¹‹å‰ä½ çš„æ“ä½œ

é—®é¢˜ä¸å¯èƒ½æ— ç¼˜æ— æ•…çš„å‡ºç°ï¼Œå¦‚æœå‡ºç°äº†ï¼Œé‚£ä¹ˆå¤§æ¦‚ç‡äº‹å‡ºæœ‰å› ã€‚å›å¿†é—®é¢˜å‡ºç°ä¹‹å‰ä½ ä½¿ç”¨äº†ä»€ä¹ˆåº”ç”¨ï¼Œåˆ é™¤äº†ä»€ä¹ˆæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯è¿›è¡Œäº†ä¸€æ¬¡windowsæ›´æ–°ã€‚é€šè¿‡å›å¿†ä½ çš„æ“ä½œæœ‰åŠ©äºä½ æœç´¢è§£å†³æ–¹æ¡ˆæ—¶æ›´å¿«åœ°ç­›é€‰å‡ºæ­£ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚

## ç¬¬äºŒæ­¥ï¼šåˆ¤æ–­ä½ çš„é—®é¢˜

åˆ¤æ–­ä½ çš„é—®é¢˜æ˜¯ä¸€ä¸ªé‡è¦çš„æ­¥éª¤ï¼Œå®ƒèƒ½å¤Ÿå¸®åŠ©ä½ æ­£ç¡®åœ°ä»æœç´¢å¼•æ“å¾—åˆ°ç­”æ¡ˆï¼›åŒæ—¶ï¼Œæ›´ä¸ºè¯¦ç»†çš„é—®é¢˜ä¹Ÿæœ‰åŠ©äºæœç´¢å¼•æ“ç´¢å¼•ç­”æ¡ˆï¼Œæ¯”å¦‚â€œç”µè„‘è“å± 0x000532542â€æ¯”â€œç”µè„‘è“å±â€æ›´æœ‰å¯èƒ½å¾—åˆ°ä½ æƒ³è¦åœ°ç­”æ¡ˆã€‚

## ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨æœç´¢å¼•æ“æˆ–ç«™ç‚¹

å¯¹äºè¾ƒä¸ºæ™®é€šçš„é—®é¢˜ï¼Œé‚£ä¹ˆæœç‹—ï¼Œç™¾åº¦å¤§æ¦‚ç‡å¯ä»¥åº”ä»˜ï¼Œæ¯”å¦‚â€œç½‘ç»œé‡ç½®â€ï¼Œâ€œDNSç¼“å­˜æ¸…é™¤â€ç­‰ç­‰ï¼›

è€Œå¯¹äºæ¯”è¾ƒå¤æ‚çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡Fæœè¿™ç§æœç´¢å¼•æ“ï¼Œä¹Ÿå¯ä»¥é€šè¿‡çŸ¥ä¹ï¼Œç®€ä¹¦ç­‰åº”ç”¨çš„ç«™å†…æœç´¢ï¼›

å¯¹äº**æœ‰æ¡ä»¶**çš„åŒå­¦ï¼Œå»ºè®®ä½¿ç”¨ google æœç´¢ï¼›è€Œå¦‚æœä¸­æ–‡äº’è”ç½‘æ— æ³•ç»™å‡ºä½ æ»¡æ„çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥å€ŸåŠ© google ç¿»è¯‘è·å¾—ä½ æ»¡æ„çš„ç­”æ¡ˆã€‚

é¡ºä¾¿æ’ä¸€å¥ï¼Œè™½ç„¶ç”¨çš„æ˜¯windowsï¼Œä½†æ˜¯å°è¯•è‡ªå·±è§£å†³é—®é¢˜çš„æ—¶å€™æœ€å¥½çŸ¥é“è‡ªå·±åšçš„æ˜¯ä»€ä¹ˆï¼Œç—…æ€¥ä¹±æŠ•åŒ»åªä¼šè®©é—®é¢˜æ›´åŠ å¤æ‚

## ç¬¬å››æ­¥ï¼šå…³äºEç®¡å®¶

å¦‚æœä½ è§£å†³å…³äºä½ ç”µè„‘çš„é—®é¢˜ï¼Œå¯ä»¥æŠŠä½ çš„è§£å†³è¿‡ç¨‹ï¼ˆåŒ…æ‹¬ç³»ç»Ÿç¯å¢ƒï¼Œé—®é¢˜æ‰€åœ¨ï¼Œè§£å†³æ–¹æ³•ï¼‰å‘ç»™æˆ‘ä»¬ç•™å­˜æ¡£æ¡ˆï¼Œæ–¹ä¾¿æ›´å¤šåŒå­¦æ”¶ç›Šï¼›

å¦‚æœä½ å¯¹äºä¸€åˆ°ä¸‰ä¸å¤ªç†Ÿæ‚‰ï¼Œè¯·ç›´æ¥è”ç³»Eç®¡å®¶ï¼Œè®©æˆ‘ä»¬æ¥è§£å†³ä½ çš„çƒ¦æ¼ã€‚

æˆ‘ä»¬çš„å…¬ä¼—å·QQï¼š2985586863

æˆ‘ä»¬çš„æœåŠ¡ç¾¤ï¼š728568691

PSï¼šå…³äºæœç´¢éƒ¨åˆ†çš„â€œæœ‰æ¡ä»¶â€ï¼Œæˆ‘ä»¬å·²ç»åœ¨å¼€å§‹ç»™å‡ºäº†ç­”æ¡ˆğŸ¤«ğŸ¤«ğŸ¤«

## è¿›é˜¶éƒ¨åˆ†

å®é™…ä¸Šï¼Œwindowsä¹Ÿæ˜¯æœ‰å´©æºƒæ—¥å¿—çš„ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨WinDbg Previewè¿›è¡Œåœ¨C:\Windows\Minidumpæ‰¾åˆ°dmpæ–‡ä»¶è¿›è¡Œåˆ†æ

ä¸€èˆ¬æ¥è¯´ï¼Œå¯åŠ¨è½¯ä»¶åä¼šè‡ªåŠ¨æ£€æµ‹æœ€æ–°dmp[æ—¥å¿—æ–‡ä»¶](https://www.zhihu.com/search?q=æ—¥å¿—æ–‡ä»¶&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra={"sourceType"%3A"answer"%2C"sourceId"%3A2584007159})ï¼Œå¯ä»¥ç›´æ¥è½½å…¥åˆ†æ

è½½å…¥å®Œæˆåï¼Œçª—å£ä¸­ä¼šå‡ºç°!analyze -vè¶…é“¾æ¥æŒ‰é’®

å¯ä»¥å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„æ–‡ä»¶

```bash
||2:6: kd> !analyze -v
*******************************************************************************
*                                                                             *
*                        Bugcheck Analysis                                    *
*                                                                             *
*******************************************************************************

IRQL_NOT_LESS_OR_EQUAL (a)
An attempt was made to access a pageable (or completely invalid) address at an
interrupt request level (IRQL) that is too high.  This is usually
caused by drivers using improper addresses.
If a kernel debugger is available get the stack backtrace.
Arguments:
Arg1: ffffffafe367f6bc, memory referenced
Arg2: 0000000000000002, IRQL
Arg3: 0000000000000000, bitfield :
	bit 0 : value 0 = read operation, 1 = write operation
	bit 3 : value 0 = not an execute operation, 1 = execute operation (only on chips which support this level of status)
Arg4: fffff80765c4af31, address which referenced memory

Debugging Details:
------------------


KEY_VALUES_STRING: 1

    Key  : Analysis.CPU.mSec
    Value: 6437

    Key  : Analysis.DebugAnalysisManager
    Value: Create

    Key  : Analysis.Elapsed.mSec
    Value: 6546

    Key  : Analysis.Init.CPU.mSec
    Value: 3046

    Key  : Analysis.Init.Elapsed.mSec
    Value: 105711

    Key  : Analysis.Memory.CommitPeak.Mb
    Value: 122


FILE_IN_CAB:  102121-7515-01.dmp

DUMP_FILE_ATTRIBUTES: 0x8
  Kernel Generated Triage Dump

BUGCHECK_CODE:  a

BUGCHECK_P1: ffffffafe367f6bc

BUGCHECK_P2: 2

BUGCHECK_P3: 0

BUGCHECK_P4: fffff80765c4af31

READ_ADDRESS: fffff807666fb390: Unable to get MiVisibleState
Unable to get NonPagedPoolStart
Unable to get NonPagedPoolEnd
Unable to get PagedPoolStart
Unable to get PagedPoolEnd
unable to get nt!MmSpecialPagesInUse
 ffffffafe367f6bc 

BLACKBOXBSD: 1 (!blackboxbsd)


BLACKBOXNTFS: 1 (!blackboxntfs)


BLACKBOXPNP: 1 (!blackboxpnp)


BLACKBOXWINLOGON: 1

CUSTOMER_CRASH_COUNT:  1

PROCESS_NAME:  System

TRAP_FRAME:  fffffd83c147f430 -- (.trap 0xfffffd83c147f430)
NOTE: The trap frame does not contain all registers.
Some register values may be zeroed or incorrect.
rax=0000000000000000 rbx=0000000000000000 rcx=ffff9180c67d6180
rdx=0000000000000000 rsi=0000000000000000 rdi=0000000000000000
rip=fffff80765c4af31 rsp=fffffd83c147f5c0 rbp=0000000000000003
 r8=0000000000000000  r9=0000000000000000 r10=000000000000ffff
r11=ffff9180c67d6180 r12=0000000000000000 r13=0000000000000000
r14=0000000000000000 r15=0000000000000000
iopl=0         nv up ei ng nz na po nc
nt!KiDeferredReadySingleThread+0x3e1:
fffff807`65c4af31 0fbebbc3000000  movsx   edi,byte ptr [rbx+0C3h] ds:00000000`000000c3=??
Resetting default scope

STACK_TEXT:  
fffffd83`c147f2e8 fffff807`65e07d69     : 00000000`0000000a ffffffaf`e367f6bc 00000000`00000002 00000000`00000000 : nt!KeBugCheckEx
fffffd83`c147f2f0 fffff807`65e04069     : 00000000`00000000 00000000`0000ffff 00000000`00000000 fffff807`00000000 : nt!KiBugCheckDispatch+0x69
fffffd83`c147f430 fffff807`65c4af31     : 00000000`00000000 ffffa505`216d8080 00000000`00000008 00000000`00000000 : nt!KiPageFault+0x469
fffffd83`c147f5c0 fffff807`65c44c4d     : 00000000`0016708a fffffd83`c147fa10 00000000`00000080 ffff9180`c67d6180 : nt!KiDeferredReadySingleThread+0x3e1
fffffd83`c147f7b0 fffff807`65c45030     : ffff9180`c67d6180 00000000`00000000 ffffa505`219481f0 ffffa505`017db1b0 : nt!KiReadyThread+0x4d
fffffd83`c147f7e0 fffff807`65c06eed     : 00000000`00000000 00000000`00000000 00000000`00140001 00000000`0016708a : nt!KiProcessExpiredTimerList+0x290
fffffd83`c147f8d0 fffff807`65df99ae     : ffffffff`00000000 ffff9180`c67d6180 ffff9180`c67e1440 ffffa505`22607080 : nt!KiRetireDpcList+0x5dd
fffffd83`c147fb60 00000000`00000000     : fffffd83`c1480000 fffffd83`c1479000 00000000`00000000 00000000`00000000 : nt!KiIdleLoop+0x9e


SYMBOL_NAME:  nt!KiDeferredReadySingleThread+3e1

MODULE_NAME: nt

IMAGE_NAME:  ntkrnlmp.exe

IMAGE_VERSION:  10.0.19041.928

STACK_COMMAND:  .cxr; .ecxr ; kb

BUCKET_ID_FUNC_OFFSET:  3e1

FAILURE_BUCKET_ID:  AV_nt!KiDeferredReadySingleThread

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

FAILURE_ID_HASH:  {626f59d5-90cc-ab48-85f0-60e170096c96}

Followup:     MachineOwner
---------
```

é€šè¿‡é˜…è¯»æœ€åä¸€æ®µçš„åˆ†æå¯ä»¥å¿«é€Ÿå®šä½å¤§æ¦‚çš„é—®é¢˜æ–¹å‘

```bash
SYMBOL_NAME:  nt!KiDeferredReadySingleThread+3e1

MODULE_NAME: nt

IMAGE_NAME:  ntkrnlmp.exe

IMAGE_VERSION:  10.0.19041.928

STACK_COMMAND:  .cxr; .ecxr ; kb

BUCKET_ID_FUNC_OFFSET:  3e1

FAILURE_BUCKET_ID:  AV_nt!KiDeferredReadySingleThread

OSPLATFORM_TYPE:  x64

OSNAME:  Windows 10

FAILURE_ID_HASH:  {626f59d5-90cc-ab48-85f0-60e170096c96}

Followup:     MachineOwner
```

æ¯”å¦‚è¿™é‡Œå¤§æ¦‚çŸ¥é“æ˜¯winçš„NTå†…æ ¸å‡ºé—®é¢˜äº†ï¼Œä¸è¿‡ä¸€èˆ¬æ¥è¯´è¿™åªèƒ½å½“ä½œä¸€ä¸ªé—®çš„è§£å†³æ–¹å‘ï¼Œä¸èƒ½å½“ä½œåŸå› 

å¦‚æœè¦æ›´ç²¾å‡†åœ°å®šä½é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ£€ç´¢PROCESS_NAMEã€MODULE_NAME ã€ IMAGE_NAMEå’ŒFAILURE BUCKET_IDç­‰å…³é”®è¯å®šä½é—®é¢˜

# PSï¼šå¦‚æœè‡ªå·±éƒ½å¯¹è‡ªå·±çš„é—®é¢˜ä¸ä¸Šå¿ƒçš„è¯ï¼Œå°±ä¸è¦æŒ‡æœ›åˆ«äººä¼šä¸Šå¿ƒäº†